---

{%- raw %}
# https://github.com/pnbruckner/ha-sun2
-
  platform: sun2
  monitored_conditions:
    - sunrise
    - sunset

# https://github.com/mampfes/hacs_waste_collection_schedule
-
  name: Waste Collection Schedule - Waste
  source_index: 0
  types: [Waste]
  <<: &waste_collection_schedule
    platform: waste_collection_schedule
    details_format: upcoming
    add_days_to: true
    value_template: >-
      {% set today = now() %}

      {% if value.daysTo == 0 %}
        Today

      {% elif value.daysTo == 1 %}
        Tomorrow

      {% elif value.date.isocalendar().week == today.isocalendar().week %}
        {{ value.date.strftime("%A")}}

      {% elif value.date.isocalendar().week - today.isocalendar().week == 1 %}
        Next {{ value.date.strftime("%A")}}

      {% elif value.date.isocalendar().week - today.isocalendar().week == 2 %}
        In 2 weeks

      {% else %}
        {{ value.date }} ({{value.daysTo}} days)

      {% endif %}
-
  name: Waste Collection Schedule - Recycling
  source_index: 0
  types: [Recycling]
  <<: *waste_collection_schedule
-
  name: Waste Collection Schedule - Organics
  source_index: 0
  types: [Organics]
  <<: *waste_collection_schedule
-
  name: Waste Collection Schedule - Bulk Household
  source_index: 0
  types: [Bulk Household]
  <<: *waste_collection_schedule
-
  name: Waste Collection Schedule - Soft Plastics
  source_index: 1
  types: [Pickup]
  <<: *waste_collection_schedule

# converts kW to kWh for the following solar/grid import/export sensors
# https://www.home-assistant.io/integrations/integration/
-
  platform: integration
  name: Grid Power Import
  unique_id: grid_power_import_kwh
  source: sensor.grid_power_consumption
  method: left
  unit_prefix: k
  unit_time: h
-
  platform: integration
  name: Grid Power Export
  unique_id: grid_power_export_kwh
  source: sensor.grid_power_export
  method: left
  unit_prefix: k
  unit_time: h
-
  platform: integration
  name: Solar Self Consumption
  unique_id: solar_self_consumption_kwh
  source: sensor.solar_self_consumption
  method: left
  unit_prefix: k
  unit_time: h

{%- endraw %}

# https://www.home-assistant.io/integrations/transport_nsw
-
  platform: transport_nsw
  name: "Train to Central"
  stop_id: "213710"
  destination: "Gordon via Central"
  api_key: "{{ home_assistant_integrations.transport_nsw_api_key }}"
-
  platform: transport_nsw
  name: "Train to Epping"
  stop_id: "213710"
  destination: "Hornsby via Eastwood"
  api_key: "{{ home_assistant_integrations.transport_nsw_api_key }}"

# https://github.com/mark1foley/ha-gtfs-rt-v2
-
  platform: gtfs_rt
  trip_update_url: https://api.transport.nsw.gov.au/v2/gtfs/realtime/sydneytrains
  vehicle_position_url: https://api.transport.nsw.gov.au/v2/gtfs/vehiclepos/sydneytrains
  api_key: "apikey {{ home_assistant_integrations.transport_nsw_api_key }}"
  departures:
    - name: Train To Central Station
      stopid: 2137171
      route: NTH_2a
      icon: mdi:train
      service_type: Train
