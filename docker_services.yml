---
- hosts: docker_services
  become: true
  vars:
    network: "{{ networks.mgmt }}"
  module_defaults:
    docker_container:
      keep_volumes: false
      restart_policy: unless-stopped
      networks_cli_compatible: true
      purge_networks: true
      dns_servers: "{{ network.dns }}"
      networks:
        - name: "{{ network.name }}"
  roles:
    - traefik
    - watchtower
    - portainer
