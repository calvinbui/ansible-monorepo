---

- name: Create JDownloader directories
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
    mode: "0770"
  loop:
    - "{{ jdownloader_config_directory }}"

- name: Set Docker container parameters
  ansible.builtin.set_fact:
    jdownloader_container_parameters:
      name: "{{ jdownloader_name }}"
      image: "{{ jdownloader_image }}"
      state: started
      published_ports: "{{ jdownloader_ports }}"
      volumes:
        - "{{ jdownloader_config_directory }}:/config"
        - "{{ jdownloader_download_directory }}:/output"
      env: "{{ jdownloader_environment_variables }}"

- name: Create JDownloader container
  community.docker.docker_container: "{{ jdownloader_container_parameters | combine(jdownloader_docker_additional_options) }}"
  register: jdownloader_container
