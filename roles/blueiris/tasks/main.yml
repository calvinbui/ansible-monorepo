---

- name: Create Blue Iris directory
  file:
    path: "{{ blueiris_config_directory }}"
    state: directory

- name: Set Docker container parameters
  set_fact:
    blueiris_container_parameters:
      name: "{{ blueiris_name }}"
      image: "{{ blueiris_image }}"
      state: started
      published_ports: "{{ blueiris_ports }}"
      volumes: "{{ blueiris_volumes }}"
      pull: true

- name: Template supervisord config
  template:
    src: supervisord.conf.j2
    dest: "{{ blueiris_config_directory }}/supervisord.conf"

- name: Create Blue Iris container
  docker_container: "{{ blueiris_container_parameters | combine(blueiris_docker_additional_options) }}"
  register: blueiris_container
