---

- hosts: homeserver

  vars:
    application: watchtower

    container_network: "{{ networks.pub }}"

  tasks:
    # podman container are not recreated the same way they were configured
    # for example, dns settings would be missing
    #
    # - name: Create container
    #   ansible.builtin.include_role:
    #     name: podman_container
    #   vars:
    #     image: ghcr.io/nicholas-fedor/watchtower:1.12.1
    #     volumes:
    #       - /run/podman/podman.sock:/var/run/docker.sock
    #     env:
    #       TZ: "{{ common_timezone }}"
    #       WATCHTOWER_SCHEDULE: "0 0 4 * * *"
    #       WATCHTOWER_CLEANUP: "true"
    #       WATCHTOWER_REMOVE_VOLUMES: "true"

    #       WATCHTOWER_DISABLE_MEMORY_SWAPPINESS: "true"

    #       WATCHTOWER_INCLUDE_STOPPED: "true"
    #       WATCHTOWER_REVIVE_STOPPED: "true"
    #     labels:
    #       - com.centurylinklabs.watchtower.enable=false
