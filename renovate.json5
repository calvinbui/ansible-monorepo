{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  ansible: {
    fileMatch: ["^.*\\.ya?ml$"],
  },

  timezone: "Australia/Sydney",

  schedule: [
    "after 5pm and before 11:59pm every weekday",
    "after 9am and before 11:59pm every weekend",
  ],

  reviewers: ["calvinbui"],

  commitMessagePrefix: "{{depName}}:",
  commitMessageAction: "update",
  commitMessageTopic: "version",
  commitMessageExtra: "to {{#if isMajor}}{{{prettyNewMajor}}}{{else}}{{{prettyNewVersion}}}{{/if}}",

  regexManagers: [
    // extract depName from Docker image
    {
      datasourceTemplate: "docker",
      fileMatch: ["^.*\\.ya?ml$"],
      matchStrings: ["\\s*image:\\s+?(?<registry>:?[\\/a-z\\.-]+\\/)*(?<depName>[\\/a-z-]+)(?::(?<currentValue>[a-z0-9.-]+))?"],
      packageNameTemplate: "{{{ registry }}}{{{ depName }}}"
    },
  ],

  // rules are evaluated in order
  packageRules: [
    /*
      override Docker datasource defaults
      https://docs.renovatebot.com/modules/datasource/#docker-datasource
    */
    {
      matchDatasources: ["docker"],
      commitMessageTopic: "version",
      digest: {
        commitMessageTopic: "digest",
        group: {
          commitMessageTopic: "digest",
        },
      },
      pin: {
        group: {
          commitMessageTopic: "version",
        },
      },
      group: {
        commitMessageTopic: "version",
      },
    },
    /*
      Plex image
    */
    {
      matchDatasources: ["docker"],
      matchPackagePatterns: ["^plexinc\\/pms-docker$"],
      versioning: "loose",
    },
    /*
      Linuxserver.io images
    */
    {
      // images prefixed with 'version'
      matchDatasources: ["docker"],
      matchPackagePatterns: ["^lscr.io\\/linuxserver\\/.*$"],
      versioning: "regex:^version-v?(?<major>\\d+)\\.(?<minor>\\d+)\\.?(?<patch>\\d+)?\\.?(?<build>.*)?$",
    },
    /*
      If all else fails
    */
    {
      matchDatasources: ["docker"],
      versioning: "loose",
    },
  ],

  prBodyTemplate: "{{{table}}}{{{notes}}}{{{changelogs}}}",
}
