{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",

  timezone: "Australia/Sydney",

  schedule: [
    "after 5pm and before 11:59pm every weekday",
    "after 9am and before 11:59pm every weekend",
  ],

  reviewers: ["calvinbui"],

  commitMessagePrefix: "{{depName}}:",
  commitMessageAction: "update",
  commitMessageTopic: "version",
  commitMessageExtra: "to {{#if isMajor}}{{{prettyNewMajor}}}{{else}}{{{prettyNewVersion}}}{{/if}}",

  regexManagers: [
    /*
      extract depName from Docker image within Ansible playbooks, i.e.:
        - image: lscr.io/linuxserver/jackett:0.20.1778 --> jackett
        - image: plexinc/pms-docker:1.28.1.6104-788f82488 --> pms-docker
        - image: image: eclipse-mosquitto:2.0.15 --> eclipse-mosquitto
    */
    {
      datasourceTemplate: "docker",
      fileMatch: ["^.*\\.ya?ml$"],
      matchStrings: ["\\s*image:\\s+?(?<registry>:?[\\/a-z\\.-]+\\/)*(?<depName>[\\/a-z-]+)(?::(?<currentValue>[a-z0-9.-]+))?"],
      packageNameTemplate: "{{{ registry }}}{{{ depName }}}",
    },
  ],

  // Renovate will evaluate all packageRules and not stop once it gets a first match
  packageRules: [
    /*
      override Docker datasource defaults
      https://docs.renovatebot.com/modules/datasource/#docker-datasource
    */
    {
      matchDatasources: ["docker"],
      commitMessageTopic: "version",
      digest: {
        commitMessageTopic: "digest",
        group: {
          commitMessageTopic: "digest",
        },
      },
      pin: {
        group: {
          commitMessageTopic: "version",
        },
      },
      group: {
        commitMessageTopic: "version",
      },
    },
    /*
      Plex image
    */
    {
      matchDatasources: ["docker"],
      matchPackagePatterns: ["^plexinc\\/pms-docker$"],
      versioning: "loose",
    },
    /*
      Umami image
    */
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["ghcr.io/mikecao/umami"],
      versioning: "regex:^postgresql-v(?<major>\\d+)\\.(?<minor>\\d+)\\.?(?<patch>\\d+)$",
    },
    /*
      Linuxserver.io images
    */
    {
      matchDatasources: ["docker"],
      matchPackageNames: ["lscr.io/linuxserver/nzbget"],
      matchUpdateTypes: ["patch"],
      automerge: true,
    },
  ],

  prBodyTemplate: "{{{table}}}{{{notes}}}{{{changelogs}}}{{{controls}}}",
}
